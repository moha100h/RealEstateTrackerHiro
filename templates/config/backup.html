{% extends 'base.html' %}

{% block extra_head %}
<style>
    .backup-card {
        border: none;
        border-radius: 1rem;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }
    
    .backup-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
    
    .backup-card .card-header {
        background-color: #f8f9fa;
        border-bottom: 1px dashed rgba(0,0,0,0.05);
        padding: 1.25rem 1.5rem;
    }
    
    .backup-card .card-body {
        padding: 1.5rem;
    }
    
    .feature-icon {
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        color: white;
        margin-bottom: 1rem;
    }
    
    .feature-title {
        font-weight: 600;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
    }
    
    .divider {
        height: 1px;
        background: linear-gradient(to right, transparent, rgba(0,0,0,0.05), transparent);
        margin: 1.5rem 0;
    }
    
    .backup-history-table th {
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 0.5px;
    }
    
    .backup-history-table tbody tr {
        transition: all 0.2s ease;
    }
    
    .backup-history-table tbody tr:hover {
        background-color: rgba(var(--primary-rgb), 0.05);
    }
    
    .backup-tabs .nav-link {
        color: var(--gray-700);
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 500;
        transition: all 0.2s ease;
    }
    
    .backup-tabs .nav-link:hover {
        background-color: var(--gray-100);
    }
    
    .backup-tabs .nav-link.active {
        background-color: var(--primary-color);
        color: white;
    }
    
    .export-options {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
    }
    
    .export-option {
        background-color: #fff;
        border-radius: 12px;
        border: 1px solid rgba(0,0,0,0.05);
        padding: 1.5rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .export-option:hover {
        border-color: var(--primary-color);
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }
    
    .export-option-icon {
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        border-radius: 50%;
        background-color: rgba(var(--primary-rgb), 0.1);
        color: var(--primary-color);
    }
    
    .wizard-title {
        margin-bottom: 2rem;
        position: relative;
        display: inline-block;
    }
    
    .wizard-title:after {
        content: '';
        display: block;
        width: 50px;
        height: 3px;
        background-color: var(--primary-color);
        position: absolute;
        bottom: -10px;
        right: 0;
    }
    
    .backup-tips {
        background-color: #f8f9fa;
        border-radius: 12px;
        padding: 1.5rem;
        margin-top: 2rem;
    }
    
    .backup-tips ul {
        list-style-type: none;
        padding: 0;
    }
    
    .backup-tips li {
        position: relative;
        padding-right: 1.5rem;
        margin-bottom: 0.75rem;
    }
    
    .backup-tips li:before {
        content: '\2022';
        color: var(--primary-color);
        font-weight: bold;
        font-size: 1.2rem;
        display: inline-block;
        width: 1.5rem;
        margin-right: -1.5rem;
        position: absolute;
        right: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="mb-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">خانه</a></li>
                <li class="breadcrumb-item"><a href="{% url 'dashboard:home' %}">داشبورد</a></li>
                <li class="breadcrumb-item active">پشتیبان‌گیری و بازیابی</li>
            </ol>
        </nav>
    </div>
    
    <div class="d-flex align-items-center mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-database text-primary me-3"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg>
        <div>
            <h1 class="mb-0">پشتیبان‌گیری و بازیابی</h1>
            <p class="text-muted mb-0">مدیریت داده‌های سیستم و تهیه نسخه پشتیبان</p>
        </div>
    </div>
    
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} d-flex" role="alert">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather {% if message.tags == 'success' %}feather-check-circle{% else %}feather-alert-circle{% endif %} flex-shrink-0 me-2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
        <div>{{ message }}</div>
    </div>
    {% endfor %}
    {% endif %}
    
    <div class="row">
        <div class="col-md-3 mb-4">
            <div class="backup-tabs">
                <nav class="nav flex-column" id="backupTabs" role="tablist">
                    <a class="nav-link active" id="backup-tab" data-bs-toggle="tab" href="#backup" role="tab" aria-controls="backup" aria-selected="true">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                        پشتیبان‌گیری
                    </a>
                    <a class="nav-link" id="restore-tab" data-bs-toggle="tab" href="#restore" role="tab" aria-controls="restore" aria-selected="false">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-upload"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                        بازیابی اطلاعات
                    </a>
                    <a class="nav-link" id="export-tab" data-bs-toggle="tab" href="#export" role="tab" aria-controls="export" aria-selected="false">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                        خروجی اکسل
                    </a>
                    <a class="nav-link" id="history-tab" data-bs-toggle="tab" href="#history" role="tab" aria-controls="history" aria-selected="false">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        تاریخچه
                    </a>
                </nav>
            </div>
            
            <div class="backup-tips mt-4">
                <h6 class="fw-bold mb-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info me-2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    توصیه‌های امنیتی
                </h6>
                <ul>
                    <li>هر هفته از اطلاعات خود پشتیبان تهیه کنید.</li>
                    <li>فایل‌های پشتیبان را در چند مکان مختلف نگهداری کنید.</li>
                    <li>هنگام بازیابی، از وارد کردن فایل‌های نامعتبر خودداری کنید.</li>
                    <li>خروجی اکسل را برای دسترسی سریع به اطلاعات در مواقع اضطراری ذخیره کنید.</li>
                </ul>
            </div>
        </div>
        
        <div class="col-md-9">
            <div class="tab-content" id="backupTabsContent">
                <!-- تب پشتیبان‌گیری -->
                <div class="tab-pane fade show active" id="backup" role="tabpanel" aria-labelledby="backup-tab">
                    <div class="card backup-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0 d-flex align-items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download me-2 text-primary"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                                ایجاد نسخه پشتیبان
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-7">
                                    <h4 class="wizard-title">پشتیبان‌گیری از سیستم</h4>
                                    <p class="text-muted mb-4">
                                        با ایجاد نسخه پشتیبان، تمامی اطلاعات سیستم شامل داده‌های املاک، کاربران، تنظیمات و سایر اطلاعات در قالب یک فایل فشرده ذخیره می‌شود. این فایل را می‌توانید بعداً برای بازیابی کامل سیستم استفاده کنید.
                                    </p>
                                    
                                    <div class="mb-4">
                                        <div class="d-flex mb-3">
                                            <div class="feature-icon" style="background-color: rgba(var(--primary-rgb), 0.1);">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shield" style="color: var(--primary-color);"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                                            </div>
                                            <div class="ms-3">
                                                <h6 class="feature-title">امنیت داده‌ها</h6>
                                                <p class="text-muted mb-0">فایل پشتیبان شامل تمام اطلاعات سیستم است و باید در مکان امنی نگهداری شود.</p>
                                            </div>
                                        </div>
                                        
                                        <div class="d-flex">
                                            <div class="feature-icon" style="background-color: rgba(25, 135, 84, 0.1);">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw" style="color: #198754;"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                                            </div>
                                            <div class="ms-3">
                                                <h6 class="feature-title">بازیابی کامل</h6>
                                                <p class="text-muted mb-0">با استفاده از این فایل می‌توانید سیستم را به طور کامل به حالت قبلی بازگردانید.</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <form method="post" action="{% url 'config:create_backup' %}">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-primary px-4">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download me-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                                            ایجاد و دانلود پشتیبان
                                        </button>
                                    </form>
                                </div>
                                <div class="col-md-5">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="180" height="180" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3" fill="rgba(var(--primary-rgb), 0.1)"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" fill="none"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" fill="rgba(var(--primary-rgb), 0.05)"></path></svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- تب بازیابی اطلاعات -->
                <div class="tab-pane fade" id="restore" role="tabpanel" aria-labelledby="restore-tab">
                    <div class="card backup-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0 d-flex align-items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-upload me-2 text-primary"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                                بازیابی اطلاعات از پشتیبان
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-warning d-flex" role="alert">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle flex-shrink-0 me-2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                                <div>
                                    <h5 class="alert-heading">هشدار: این عملیات غیر قابل بازگشت است!</h5>
                                    <p class="mb-0">بازیابی از پشتیبان، تمام اطلاعات فعلی را با اطلاعات موجود در فایل پشتیبان جایگزین می‌کند. پیش از انجام این کار، از داده‌های فعلی خود پشتیبان بگیرید.</p>
                                </div>
                            </div>
                            
                            <div class="row mt-4">
                                <div class="col-md-7">
                                    <h4 class="wizard-title">بازیابی اطلاعات</h4>
                                    <p class="text-muted mb-4">
                                        فایل پشتیبان ایجاد شده قبلی (با فرمت ZIP) را انتخاب کنید. پس از بازیابی، سیستم دقیقاً به همان وضعیتی که در زمان ایجاد پشتیبان داشت، بازخواهد گشت.
                                    </p>
                                    
                                    <form method="post" action="{% url 'config:restore_backup' %}" enctype="multipart/form-data" class="mb-4">
                                        {% csrf_token %}
                                        <div class="mb-4">
                                            <label for="backup_file" class="form-label fw-bold">انتخاب فایل پشتیبان (فرمت ZIP)</label>
                                            <input type="file" name="backup_file" id="backup_file" class="form-control" accept=".zip" required>
                                            <div class="form-text mt-2">
                                                فقط فایل‌های با پسوند .zip قابل استفاده هستند. حجم فایل نباید بیشتر از 100 مگابایت باشد.
                                            </div>
                                        </div>
                                        
                                        <div class="form-check mb-4">
                                            <input class="form-check-input" type="checkbox" id="confirm_restore" required>
                                            <label class="form-check-label" for="confirm_restore">
                                                من از خطرات بازیابی اطلاعات آگاه هستم و تأیید می‌کنم که این عملیات غیر قابل بازگشت است.
                                            </label>
                                        </div>
                                        
                                        <button type="submit" class="btn btn-danger px-4" onclick="return confirm('آیا از بازیابی اطلاعات از فایل پشتیبان اطمینان دارید؟ این عملیات تمام اطلاعات فعلی را با اطلاعات فایل پشتیبان جایگزین می‌کند.')">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-upload me-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                                            بازیابی اطلاعات
                                        </button>
                                    </form>
                                </div>
                                <div class="col-md-5">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="180" height="180" viewBox="0 0 24 24" fill="none" stroke="#dc3545" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18" fill="rgba(220,53,69,0.1)"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line><line x1="2" y1="12" x2="22" y2="12"></line><line x1="2" y1="7" x2="7" y2="7"></line><line x1="2" y1="17" x2="7" y2="17"></line><line x1="17" y1="17" x2="22" y2="17"></line><line x1="17" y1="7" x2="22" y2="7"></line></svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- تب خروجی اکسل -->
                <div class="tab-pane fade" id="export" role="tabpanel" aria-labelledby="export-tab">
                    <div class="card backup-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0 d-flex align-items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text me-2 text-primary"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                                خروجی اکسل از اطلاعات
                            </h5>
                        </div>
                        <div class="card-body">
                            <h4 class="wizard-title">صدور اطلاعات به فرمت اکسل</h4>
                            <p class="text-muted mb-4">
                                این قابلیت به شما امکان می‌دهد نسخه‌ای از داده‌های سیستم را به فرمت اکسل دریافت کنید. این خروجی می‌تواند در شرایط اضطراری یا برای ارائه گزارش به افراد خارج از سیستم مفید باشد.
                            </p>
                            
                            <div class="export-options">
                                <a href="{% url 'config:export_properties_excel' %}" class="export-option text-decoration-none">
                                    <div class="export-option-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                                    </div>
                                    <h6 class="mb-2">اطلاعات املاک و کاربران</h6>
                                    <p class="text-muted mb-0 small">شامل تمام جزئیات املاک و کاربران سیستم</p>
                                </a>
                                
                                <a href="{% url 'config:export_data_excel' %}" class="export-option text-decoration-none">
                                    <div class="export-option-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bar-chart-2"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                                    </div>
                                    <h6 class="mb-2">اطلاعات پایه و آمار سیستم</h6>
                                    <p class="text-muted mb-0 small">شامل آمار و اطلاعات کلی سیستم</p>
                                </a>
                            </div>
                            
                            <div class="divider"></div>
                            
                            <div class="alert alert-info d-flex" role="alert">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info flex-shrink-0 me-2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                                <div>
                                    <p class="mb-0">فایل‌های اکسل خروجی گرفته شده فقط برای مشاهده و بررسی است و قابل استفاده برای بازیابی سیستم نیستند. برای بازیابی کامل سیستم، از قسمت «پشتیبان‌گیری» استفاده کنید.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- تب تاریخچه -->
                <div class="tab-pane fade" id="history" role="tabpanel" aria-labelledby="history-tab">
                    <div class="card backup-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0 d-flex align-items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock me-2 text-primary"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                تاریخچه پشتیبان‌گیری
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover backup-history-table">
                                    <thead class="table-light">
                                        <tr>
                                            <th>نام فایل</th>
                                            <th>تاریخ ایجاد</th>
                                            <th>ایجاد کننده</th>
                                            <th>حجم</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for backup in backups %}
                                        <tr>
                                            <td>{{ backup.file_name }}</td>
                                            <td>{{ backup.created_at|date:"Y/m/d H:i" }}</td>
                                            <td>{{ backup.created_by.get_full_name|default:backup.created_by.username }}</td>
                                            <td>{{ backup.get_file_size_display }}</td>
                                        </tr>
                                        {% empty %}
                                        <tr>
                                            <td colspan="4" class="text-center text-muted py-5">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info mb-3"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                                                <h6>هیچ پشتیبانی تاکنون ایجاد نشده است</h6>
                                                <p class="small">برای ایجاد اولین پشتیبان، از تب «پشتیبان‌گیری» استفاده کنید</p>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            
                            {% if backups %}
                            <div class="mt-4">
                                <div class="alert alert-light border">
                                    <div class="d-flex align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar me-2 text-primary"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                                        <span class="fw-bold">آخرین پشتیبان‌گیری:</span>
                                        <span class="mx-2">{{ backups.first.created_at|date:"Y/m/d H:i" }}</span>
                                        <span class="text-muted">({{ backups.first.created_by.get_full_name|default:backups.first.created_by.username }})</span>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // فعال کردن تب‌ها با بوتسترپ
    var triggerTabList = [].slice.call(document.querySelectorAll('#backupTabs a'))
    triggerTabList.forEach(function(triggerEl) {
        var tabTrigger = new bootstrap.Tab(triggerEl)
        triggerEl.addEventListener('click', function(event) {
            event.preventDefault()
            tabTrigger.show()
        })
    });
});
</script>
{% endblock %}
